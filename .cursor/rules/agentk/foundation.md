# 구조 설계의 기본 개념 (Foundation)

## 개요

이 문서는 구조 설계 활동을 수행하는 모든 에이전트가 공통으로 이해하고 따라야 할 기본 개념과 원칙을 정의합니다.

## 핵심 원칙

### 1. 최적 설계 (Optimal Design)

**정의**: 비즈니스 전반에 걸쳐 최고의 품질 수준을 달성하는 설계

**핵심 개념**:
- 목표: 최적 개발 및 유지보수
- 설계 결정은 품질에 양방향 영향을 미침 (어떤 품질은 향상, 다른 품질은 저하)
- 최적 설계 = 모든 품질 요구사항을 고려한 최선의 설계 결정 선정

**에이전트 가이드**:
- 단일 품질만을 고려하지 말고 전체 품질 균형을 고려해야 함
- 트레이드오프(tradeoffs)를 명시적으로 분석하고 문서화해야 함

### 2. 품질 요구사항 (Quality Requirements)

시스템의 품질을 평가하는 요구사항. 두 가지 유형으로 구분됨:

#### 2.1 비기능적 요구사항 (NFR: Non-Functional Requirement)

**정의**: 반드시 만족해야 하는 품질 요구사항

**특징**:
- 만족하지 못하면 과제 실패 (시장 진입 불가)
- 측정 값에 대한 명확한 허용치 필요
- 허용치 이상으로 만족하는 것은 요구하지 않음

**예시**:
- `[부팅 시간] < 2초`
- `[동시 접속자] >= 10,000명`
- `[가용성] >= 99.9%`

**에이전트 가이드**:
- 허용치를 명확히 정의해야 함

#### 2.2 품질 속성 (QA: Quality Attribute)

**정의**: 더 많이 만족할수록 좋은 품질 요구사항

**특징**:
- 시스템의 평가 요인이자 시장 경쟁력의 척도
- 우선순위가 중요
- 명확한 허용치 없음 (더 좋을수록 유리)
- 우선순위 높은 QA를 위해 낮은 QA는 희생 가능

**에이전트 가이드**:
- 품질 속성 간 우선순위를 명확히 해야 함
- 트레이드오프 발생 시 우선순위 높은 QA를 우선해야 함
- 하나의 시나리오가 NFR이면서 QA일 수 있음

### 3. 구조적 의사결정 (Architectural Decision)

**정의**: 중요한 품질 요구사항에 영향을 미치는 중요한 설계 결정

**핵심 개념**:
- 모든 설계 결정이 중요한 것은 아님
- 최적 설계에 큰 영향을 미치는 결정만 구조적 의사결정으로 분류
- 구조 설계 활동의 핵심 대상

**에이전트 가이드**:
- 설계 결정이 어떤 품질 요구사항에 어떻게 영향을 미치는지 분석해야 함
- 영향도가 낮은 결정은 구조적 의사결정으로 다룰 필요 없음

## 에이전트 공통 행동 원칙

### 0. 작업 디렉토리 설정의 원칙

- 모든 설계 산출물은 **작업 디렉토리** 내에 생성해야 함
- 작업 디렉토리 결정 순서:
  1. 대화 중 사용자가 명시적으로 지정한 디렉토리
  2. VS Code 설정 `agentk.architectureDirectory` (`.vscode/settings.json`)
  3. 사용자 전역 설정의 `agentk.architectureDirectory`
  4. 기본값: `docs`

- 모든 구현 산출물은 **소스 디렉토리** 내에 생성해야 함
- 소스 디렉토리 결정 순서:
  1. 대화 중 사용자가 명시적으로 지정한 디렉토리
  2. VS Code 설정 `agentk.sourceDirectory` (`.vscode/settings.json`)
  3. 사용자 전역 설정의 `agentk.sourceDirectory`
  4. 기본값: `src`

**에이전트 가이드**:
- 산출물 생성 전 `.vscode/settings.json` 파일을 읽어서 `agentk.architectureDirectory` 와 `agentk.sourceDirectory` 설정 확인
- `.vscode/settings.json` 파일이 없거나 설정이 없으면 기본값 `docs` 사용
- 사용자가 대화 중 다른 디렉토리를 지정하면 해당 디렉토리 우선 사용
- 디렉토리가 없으면 자동 생성

### 1. 활동 집중의 원칙

- 각 에이전트는 자신의 활동에만 집중
- 다른 활동은 다른 에이전트에게 위임
- 명확한 책임 경계 유지

### 2. 문서 참조의 원칙

- 활동 목표 달성에 필요한 정보를 기존 문서에서 먼저 참조
- 관련 산출물을 철저히 분석
- 문서 간 일관성 유지

### 3. 사용자 질문의 원칙

- 기존 문서로 충분하지 않은 정보는 사용자에게 질문
- 명확하고 구체적인 질문
- 불필요한 가정 없이 정확한 정보 수집

### 4. 용어 사용의 원칙

- 모든 에이전트는 일관된 용어를 사용해야 함
  - 구조적 의사결정 (Architectural Decision)
  - 품질 요구사항 (NFR vs QA)
  - 후보 구조 (Candidate Architecture)
  - 최종 구조 (Final Architecture)
- 새로운 용어 사용 시 명확한 정의 제공
- 약어 사용 시 glossary.md의 약어 목록 준수 (UC, QS, CA, NFR, QA 등)
- 문서 참조 시 정확한 ID 형식 사용 (UC-001, QS-001, CA-001)

### 5. 다이어그램 작성의 원칙

- **모든 다이어그램은 가급적 Mermaid 문법을 사용**해야 함
- Mermaid의 장점:
  - 구조화된 문법으로 관계와 계층을 명확히 표현
  - LLM이 파싱하고 생성하기 용이
  - 사람도 렌더링해서 시각적으로 확인 가능
  - 일관성 있는 표현 방식
- 다이어그램 유형별 Mermaid 문법:
  - 설계 과정 마인드맵: `graph TD` (top-down) 또는 `graph LR` (left-right)
  - 시퀀스 다이어그램: `sequenceDiagram`
  - 컴포넌트 관계도: `graph LR` 또는 `C4Context`
  - 상태 변화: `stateDiagram-v2`
  - 플로우차트: `flowchart TD`
- 예외: 매우 간단한 리스트나 계층 구조는 들여쓰기된 텍스트 사용 가능

**에이전트 가이드**:
- 아키텍처 다이어그램, 설계 과정, 관계도 등은 반드시 Mermaid 사용
- ASCII 아트나 텍스트 기반 다이어그램은 지양
- Mermaid로 표현하기 어려운 경우에만 텍스트 사용

### 6. 목표 달성의 원칙

- 활동의 목표 달성에 집중
- 명시된 산출물 생성
- 품질 기준 준수

**에이전트 가이드**:
- 설계 결정 시 트레이드오프를 명시적으로 분석
- 우선순위 높은 품질 속성을 우선 고려
- 트레이드오프를 문서화하여 의사결정 근거 제공

### 7. 단계별 수행의 원칙

- 응답 길이 제한을 피하기 위해 **반드시 단계별로 수행**할 것
- 복잡한 작업은 여러 단계로 분할하여 진행
- 각 단계의 완료 후 다음 단계로 진행

**에이전트 가이드**:
- 대량의 산출물 생성이 필요한 경우 한 번에 모두 생성하지 말고 단계별로 분할
- 긴 응답이 예상되는 경우 작업을 작은 단위로 나누어 수행
- 사용자에게 진행 상황을 알리며 단계적으로 완료
