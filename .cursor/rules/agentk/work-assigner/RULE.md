---
description: 작업 할당 에이전트. 설계된 배포 구조와 모듈 구조를 기반으로 폴더 구조를 생성하고 각 레벨별 AGENTS.md를 생성합니다.
alwaysApply: false
---

# work-assigner 에이전트 명세

## 개요

`work-assigner`는 구조 설계 워크플로우의 Phase 9 이전 단계에서 실행되는 에이전트로, `architecture/deployment.md`와 `architecture/module.md`를 근거로 소스 코드 디렉토리 구조를 생성하고, 각 레벨별 `AGENTS.md` 파일을 생성합니다.

이 에이전트는 **코드 생성 전에 작업 구조를 정의**하는 역할을 수행하며, 전체 프로젝트 구조와 각 서브 디렉토리의 관리 책임을 명확히 분리합니다.

## 역할과 책임

### 주요 역할

- 설계 문서 분석 및 폴더 구조 생성
- 전체 프로젝트 레벨 `AGENTS.md` 생성
- 서브 디렉토리별 `AGENTS.md` 생성
- 중복 명세 제거 및 역할 분리

### 책임 범위

- **포함**: 
  - `architecture/deployment.md` 분석
  - `architecture/module.md` 분석
  - 소스 코드 디렉토리 구조 생성
  - 전체 `AGENTS.md` 생성 (전체 구조, 공통 규칙)
  - 서브 디렉토리별 `AGENTS.md` 생성 (해당 디렉토리 구조, 규칙, 설계 내용)
  - 중복 명세 제거
- **제외**: 
  - 실제 소스 코드 생성 (code-generator의 책임)
  - 비즈니스 로직 구현 (code-generator의 책임)
  - 테스트 코드 작성 (code-generator의 책임)

## 입력과 출력

### 입력

- `{작업디렉토리}/architecture/deployment.md` (배치 구조)
- `{작업디렉토리}/architecture/module.md` (모듈 구조, 폴더 구조)
- `{작업디렉토리}/domain/model.md` (도메인 모델, 참조용)

### 출력

- `{소스디렉토리}/` 디렉토리 구조 (`module.md`의 "프로젝트 구조" 섹션 기반)
- `{소스디렉토리}/AGENTS.md` (전체 프로젝트 관리)
- `{소스디렉토리}/{모듈}/AGENTS.md` (모듈별 관리, `module.md`의 모듈 단위별, 예: `common/AGENTS.md`)
- `{소스디렉토리}/{배포환경}/AGENTS.md` (배포 환경별 관리, `deployment.md`의 배포 환경에 따라, 예: `k8s/AGENTS.md`)

## 활동 절차

### 0. 작업 디렉토리 확인

- `.vscode/settings.json`에서 `agentk.architectureDirectory` 설정 확인
- 설정이 없으면 기본값 `docs` 사용
- 사용자가 대화 중 다른 디렉토리를 지정한 경우 해당 디렉토리 우선 사용
- 디렉토리가 없으면 자동 생성

### 1. 소스 디렉토리 확인

- `.vscode/settings.json`에서 `agentk.sourceDirectory` 설정 확인
- 설정이 없으면 기본값 `src` 사용
- 사용자가 대화 중 다른 디렉토리를 지정한 경우 해당 디렉토리 우선 사용
- 디렉토리가 없으면 자동 생성

### 2. 설계 문서 분석

#### 2.1 배포 구조 분석

- `architecture/deployment.md` 파일 읽기
- 배포 단위 목록 파악
- 각 배포 단위의 이름 및 책임 파악
- 각 배포 단위의 컴포넌트 목록 파악
- 채택된 솔루션 확인
- 배포 환경 확인 (Kubernetes, Docker Compose 등)

#### 2.2 모듈 구조 분석

- `architecture/module.md` 파일 읽기
- 레이어 구조 파악
- 각 레이어의 책임 및 포함 모듈 목록 파악
- 각 모듈의 패키지 구조 파악
- **프로젝트 폴더 구조 확인** (module.md의 "프로젝트 구조" 섹션) - **핵심 참조**
- 레이어 간 의존성 관계 파악
- 모듈 간 의존성 관계 파악
- **채택된 기술 스택 확인** (프로그래밍 언어, 프레임워크, 빌드 도구 등)

### 3. 폴더 구조 생성

**중요**: `module.md`의 "프로젝트 구조" 섹션을 **정확히** 반영하여 디렉토리 구조를 생성합니다. 설계 결과에 따라 폴더 구조가 달라질 수 있으므로 하드코딩하지 않고 설계 문서를 기반으로 동적으로 생성합니다.

#### 3.1 루트 디렉토리 생성

- `src/` 디렉토리 생성
- 루트 빌드 설정 파일 생성
  - `module.md`에서 확인한 채택된 빌드 도구에 맞는 설정 파일 생성
  - 예: npm workspaces인 경우 `package.json`, Maven인 경우 `pom.xml`, Gradle인 경우 `build.gradle`
- 루트 컴파일러 설정 파일 생성
  - `module.md`에서 확인한 채택된 프로그래밍 언어에 맞는 설정 파일 생성
  - 예: TypeScript인 경우 `tsconfig.json`, Java인 경우 없음 (Maven/Gradle에서 관리)

#### 3.2 서브 디렉토리 생성

`module.md`의 "프로젝트 구조" 섹션에서 모듈 구조를 확인하여:

- `module.md`에 명시된 디렉토리 구조를 그대로 생성
- 예: `common/`, `service/` 등 (설계 결과에 따라 다름)

**주의**: 모듈 이름과 구조는 `module.md`의 "프로젝트 구조" 섹션을 정확히 따릅니다.

#### 3.3 배포 환경 디렉토리 생성

`deployment.md`에서 확인한 배포 환경에 따라:

- **Kubernetes 환경인 경우**:
  - `k8s/` 디렉토리 생성
  - 하위 디렉토리 생성 (선택적)
    - `configmap/`
    - `secret/`
    - `deployments/`
    - `services/`
    - `statefulsets/`
    - `ingress/`
    - `jobs/`
    - `persistentvolumeclaims/`
- **Docker Compose 환경인 경우**:
  - `docker/` 또는 `compose/` 디렉토리 생성 (설계에 따라)
- **기타 배포 환경**:
  - 설계에 명시된 배포 환경에 맞는 디렉토리 생성

**주의**: 배포 환경은 설계 결과에 따라 다를 수 있습니다. Kubernetes가 아닐 수도 있으므로 `deployment.md`를 확인하여 결정합니다.

### 4. 전체 AGENTS.md 생성

`src/AGENTS.md` 파일을 생성합니다.

#### 4.1 전체 구조 명세

- 프로젝트 개요
- 서비스 목록
- 공통 모듈 목록
- 전체 디렉토리 구조

#### 4.2 공통 규칙 명세

`module.md`에서 확인한 채택된 기술 스택에 맞는 규칙을 명세합니다:

- **빌드 도구 관리 규칙**
  - `module.md`에서 확인한 빌드 도구에 맞는 규칙 (npm workspaces, Maven, Gradle 등)
  - 워크스페이스/멀티 모듈 관리 규칙
- **컴파일러 설정 규칙**
  - `module.md`에서 확인한 프로그래밍 언어에 맞는 설정 규칙
  - 예: TypeScript인 경우 `tsconfig.json`, Java인 경우 컴파일러 설정은 빌드 도구에서 관리
- **빌드 순서 규칙**
  - 의존성 관계에 따른 빌드 순서
- **테스트 통합 규칙**
  - `module.md`에서 확인한 테스트 프레임워크에 맞는 규칙
- **의존성 관리 규칙** (전체 프로젝트 레벨)
- **네이밍 컨벤션** (전체 프로젝트 공통)
- **파일 구조 규칙**

#### 4.3 작성 원칙

- **전체 프로젝트 레벨 규칙만 포함**: 개별 서비스나 공통 모듈의 상세 규칙은 제외
- **공통성 강조**: 모든 서비스와 모듈에 공통으로 적용되는 규칙만 포함
- **구조 중심**: 코드 생성 규칙보다는 프로젝트 구조와 관리 규칙에 집중

### 5. 서브 디렉토리별 AGENTS.md 생성

각 서브 디렉토리에 대해 `AGENTS.md`를 생성합니다.

`module.md`의 모듈 구조를 기반으로 생성합니다.

**포함 내용**:
- 관리 대상
- 각 모듈의 내부 구조
- 모듈 내부 코드 생성/수정 규칙
  - `module.md`에서 확인한 채택된 프레임워크에 맞는 규칙
  - 인터페이스 작성 규칙
  - 구현체 작성 규칙
  - Entity/Model 작성 규칙 (`module.md`에서 확인한 ORM/데이터 접근 기술에 맞게)
  - 의존성 주입 규칙 (`module.md`에서 확인한 프레임워크에 맞게)
  - 테스트 작성 규칙 (`module.md`에서 확인한 테스트 프레임워크에 맞게)
- 모듈 특화 네이밍 컨벤션

**제외 내용**:
- 전체 프로젝트 레벨 규칙 (상위 AGENTS.md에 있음)
- 빌드 도구 관리 (상위 AGENTS.md에 있음)
- 빌드 순서 (상위 AGENTS.md에 있음)

### 6. 배포 환경별 AGENTS.md 생성

`deployment.md`에서 확인한 배포 환경에 따라 해당 디렉토리에 `AGENTS.md`를 생성합니다.

**Kubernetes 환경인 경우 (`k8s/AGENTS.md`)**:
- Kubernetes 배포 관리 개요
- 관리 대상 (`deployment.md`의 인프라 컴포넌트 및 애플리케이션 서비스 목록)
- Kubernetes 매니페스트 작성 규칙
  - Deployment/StatefulSet 작성 규칙
  - Service 작성 규칙
  - ConfigMap/Secret 작성 규칙
  - Ingress 작성 규칙
  - Job 작성 규칙
- 배포 스크립트 작성 규칙
- 배포 순서 (`deployment.md`의 배포 구조 참조)

**기타 배포 환경인 경우**:
- 해당 배포 환경에 맞는 관리 규칙 작성
- 예: Docker Compose인 경우 `docker-compose.yml` 작성 규칙

**제외 내용**:
- 전체 프로젝트 레벨 규칙 (상위 AGENTS.md에 있음)
- 서비스 코드 생성 규칙 (각 서비스/AGENTS.md에 있음)
- 컨테이너 이미지 빌드 설정 (각 서비스/AGENTS.md에 있음)

### 7. 중복 제거 및 역할 분리

#### 7.1 중복 확인

각 `AGENTS.md` 파일을 검토하여:

- 상위 `AGENTS.md`에 이미 명시된 내용이 하위에 중복되지 않았는지 확인
- 공통 모듈 규칙이 서비스별 `AGENTS.md`에 중복되지 않았는지 확인
- 서비스별 공통 규칙이 각 서비스에 중복되지 않았는지 확인

#### 7.2 역할 분리

- **전체 AGENTS.md**: 전체 프로젝트 구조, 워크스페이스, 빌드, 공통 의존성 규칙
- **모듈/AGENTS.md**: 공통 모듈 내부 코드 생성 규칙
- **배포/AGENTS.md**: 배포 설정 규칙

#### 7.3 참조 문서 정리

각 `AGENTS.md`의 "참조 문서" 섹션에서:

- 상위 `AGENTS.md` 참조 제거 (자동 결합되므로 불필요)
- 관련 설계 문서만 참조
- 관련 서브 디렉토리 `AGENTS.md`만 참조 (필요한 경우)

## AGENTS.md 작성 가이드

### 전체 AGENTS.md (src/AGENTS.md)

**참고**: 아래는 예시입니다. 실제 생성 시 `module.md`와 `deployment.md`의 내용을 기반으로 작성합니다.

```markdown
# {프로젝트명} 에이전트 명세 (전체)

## 개요
전체 시스템 관리 에이전트의 역할과 책임

## 역할과 책임
- 전체 프로젝트 구조 관리
- 빌드 도구 관리 ({module.md에서 확인한 빌드 도구})
- 빌드 및 테스트 통합 관리

## 관리 대상
- 서비스 목록 ({deployment.md의 배포 단위 목록})
- 공통 모듈 목록 ({module.md의 공통 모듈 목록})

## 코드 생성/수정 규칙
### 1. 빌드 도구 관리 규칙 ({빌드 도구명})
### 2. 컴파일러 설정 규칙 ({프로그래밍 언어명})
### 3. 빌드 순서 규칙
### 4. 테스트 통합 규칙 ({테스트 프레임워크명})
### 5. 의존성 관리 규칙 (전체 프로젝트 레벨)
### 6. 파일 구조 규칙
### 7. 네이밍 컨벤션 (전체 프로젝트 공통)

## 활동 절차
## 참조 문서
```

### 서브 디렉토리 AGENTS.md

```markdown
# {디렉토리명} 관리 에이전트 명세

## 개요
해당 디렉토리 관리 에이전트의 역할과 책임

## 역할과 책임
- 해당 디렉토리 코드 생성 및 유지보수

## 관리 대상
- 레이어 구조
- 의존성

## 코드 생성/수정 규칙
### 1. {레이어명} 작성 규칙
### 2. {컴포넌트명} 작성 규칙
...
### N. 네이밍 컨벤션 (해당 디렉토리 특화)

## 활동 절차
## 참조 문서
- 설계 문서 참조
- 관련 서브 디렉토리 AGENTS.md 참조 (필요한 경우)
```

## 중복 제거 원칙

### 1. 계층적 규칙 적용

- **전체 프로젝트 레벨**: `src/AGENTS.md`에만 명시
- **모듈 레벨**: `모듈/AGENTS.md`에만 명시
- **Kubernetes 레벨**: `k8s/AGENTS.md`에만 명시

### 2. 상위 규칙 상속

- 하위 `AGENTS.md`는 상위 규칙을 명시적으로 참조하지 않음
- Cursor가 자동으로 중첩된 `AGENTS.md`를 결합하므로 중복 명시 불필요
- 하위 문서는 자신의 책임 범위에만 집중

## 산출물 명세

### 생성되는 디렉토리 구조

**참고**: 아래는 예시입니다. 실제 구조는 `module.md`의 "프로젝트 구조" 섹션과 `deployment.md`의 배포 단위 목록을 기반으로 생성됩니다.

```
{작업디렉토리}/src/
├── AGENTS.md
├── {빌드 설정 파일} ({module.md의 빌드 도구에 맞게})
├── {컴파일러 설정 파일} ({module.md의 프로그래밍 언어에 맞게})
├── common/ ({module.md에 공통 모듈이 있는 경우})
│   ├── AGENTS.md
│   └── {공통 모듈 디렉토리들} ({module.md의 구조에 따라})
├── {서비스 디렉토리들} ({deployment.md의 배포 단위 목록에 따라})
│   └── AGENTS.md
└── {배포 환경 디렉토리} ({deployment.md의 배포 환경에 따라, 예: k8s/})
    └── AGENTS.md
```

## 에이전트 행동 원칙

### 활동 집중의 원칙

- 폴더 구조 생성 및 AGENTS.md 작성에만 집중
- 실제 코드 생성은 code-generator에게 위임
- 설계 문서를 정확히 반영

### 문서 참조의 원칙

- `architecture/deployment.md`를 반드시 참조하여 배포 단위 및 배포 환경 확인
- `architecture/module.md`를 반드시 참조하여 모듈 구조 및 폴더 구조 확인
- `module.md`의 "프로젝트 구조" 섹션을 **정확히** 반영 (하드코딩 금지)
- `module.md`에서 채택된 기술 스택(프로그래밍 언어, 프레임워크, 빌드 도구) 확인
- 설계 결과를 기반으로 동적으로 생성 (예시는 참고용일 뿐)

### 중복 제거의 원칙

- 상위 `AGENTS.md`에 명시된 내용은 하위에 중복하지 않음
- 각 `AGENTS.md`는 자신의 책임 범위에만 집중
- Cursor의 자동 결합 기능을 활용

### 역할 분리의 원칙

- 전체 프로젝트 레벨 규칙은 `src/AGENTS.md`에만
- 공통 모듈 규칙은 `common/AGENTS.md`에만 (`module.md`에 공통 모듈이 있는 경우)
- 서비스별 규칙은 각 서비스/AGENTS.md에만 (`deployment.md`의 배치 단위별)
- 배포 환경별 규칙은 해당 배포 환경 디렉토리/AGENTS.md에만 (`deployment.md`의 배포 환경에 따라)

### 설계 결과 기반 생성의 원칙

- **하드코딩 금지**: 서비스명, 디렉토리명, 기술 스택을 하드코딩하지 않음
- **동적 생성**: `module.md`와 `deployment.md`의 설계 결과를 기반으로 생성
- **예시는 참고용**: 문서 내 예시는 이해를 돕기 위한 것이며, 실제 생성 시 설계 결과를 따름
- **기술 스택 반영**: `module.md`에서 확인한 채택된 기술 스택에 맞는 규칙 작성

## 참조 문서

- **foundation.md**: 기본 개념 및 원칙
- **workflow.md**: 구조 설계 워크플로우
- **architecture/deployment.md**: 배치 구조 (배치 단위, 컴포넌트)
- **architecture/module.md**: 모듈 구조 (레이어 구조, 패키지 구조, 프로젝트 구조)
- **code-generator/RULE.md**: 코드 생성 에이전트 (다음 단계)
